# 文件系统的功能规划
我们最常用的外部存储就是硬盘，数据是以文件的形式保存在硬盘上的。

第一点，文件系统要有严格的组织形式，使得文件能够以块为单位进行存储。

第二点，文件系统中也要有索引区，用来方便查找一个文件分成的多个块都存放在了什么位置。

第三点，如果文件系统中有的文件是热点文件，近期经常被读取和写入，文件系统应该有缓存层。

第四点，文件应该用文件夹的形式组织起来，方便管理和查询。

第五点，Linux内核要在自己的内存里面维护一套数据结构，来保存哪些文件被哪些进程打开和使用。


# 文件系统相关命令行

首先是格式化，也即将一块盘使用命令组织成一定格式的文件系统的过程。

格式化后的硬盘，需要挂在到某个目录下面，才能作为普通的文件系统进行访问。  
mount /dev/vdc1 /根目录/用户A目录/目录1

-表示普通文件;  
d表示文件夹;  
c表示字符设备文件，这在设备那一节讲解;  
b表示块设备文件，这也在设备那一节讲解; s表示套接字socket文件，这在网络那一节讲解;  
l表示符号链接，也即软链接，就是通过名字指向另外一个文件，例如下面的代码，instance这个文件就是指向 了/var/lib/cloud/instances这个文件。  

# 文件系统相关系统调用

open

在进程中，我们会为这个打开的文件分配一个文件描述符fd(File Descriptor)。


opendir函数打开一个目录名所对应的DIR目录流。并返回指向DIR目录流的指针。流定位在DIR 目录流的第一个条目。


# 总结时刻
这一节，我们对于文件系统的主要功能有了一个总体的印象，我们通过下面这张图梳理一下。 

在文件系统上，需要维护文件的严格的格式，要通过mkfs.ext4命令来格式化为严格的格式。 

每一个硬盘上保存的文件都要有一个索引，来维护这个文件上的数据块都保存在哪里。 

文件通过文件夹组织起来，可以方便用户使用。 

为了能够更快读取文件，内存里会分配一块空间作为缓存，让一些数据块放在缓存里面。
 
在内核中，要有一整套的数据结构来表示打开的文件。 
 
在用户态，每个打开的文件都有一个文件描述符，可以通过各种文件相关的系统调用，操作这个文件描述符。